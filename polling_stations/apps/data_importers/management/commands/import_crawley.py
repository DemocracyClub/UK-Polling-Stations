from data_importers.management.commands import BaseXpressDemocracyClubCsvImporter

BRIDGEFIELD_HOUSE_UPRNS = [
    "10094455800",
    "10094455801",
    "10094455868",
    "10094455869",
    "10094455870",
    "10094455871",
    "10094455872",
    "10094455802",
    "10094455803",
    "10094455804",
    "10094455805",
    "10094455806",
    "10094455807",
    "10094455808",
    "10094455873",
    "10094455874",
    "10094455875",
    "10094455876",
    "10094455877",
    "10094455809",
    "10094455810",
    "10094455811",
    "10094455812",
    "10094455813",
    "10094455814",
    "10094455815",
    "10094455816",
    "10094455817",
    "10094455818",
    "10094455878",
    "10094455879",
    "10094455880",
    "10094455881",
    "10094455882",
    "10094455819",
    "10094455820",
    "10094455821",
    "10094455822",
    "10094455823",
    "10094455824",
    "10094455825",
    "10094455826",
    "10094455827",
    "10094455828",
    "10094455883",
    "10094455883",
    "10094455885",
    "10094455886",
    "10094455887",
    "10094455829",
    "10094455830",
    "10094455831",
    "10094455832",
    "10094455833",
    "10094455834",
    "10094455835",
    "10094455836",
    "10094455837",
    "10094455838",
    "10094455888",
    "10094455889",
    "10094455890",
    "10094455891",
    "10094455892",
    "10094455839",
    "10094455840",
    "10094455841",
    "10094455842",
    "10094455843",
    "10094455844",
    "10094455845",
    "10094455846",
    "10094455847",
    "10094455848",
    "10094455893",
    "10094455894",
    "10094455895",
    "10094455896",
    "10094455897",
    "10094455849",
    "10094455850",
    "10094455851",
    "10094455852",
    "10094455853",
    "10094455854",
    "10094455855",
    "10094455856",
    "10094455857",
    "10094455858",
    "10094455859",
    "10094455860",
    "10094455861",
    "10094455862",
    "10094455863",
    "10094455864",
    "10094455865",
    "10094455866",
    "10094455867",
    "10094455800",
    "10094455801",
    "10094455868",
    "10094455869",
    "10094455870",
    "10094455871",
    "10094455872",
    "10094455802",
    "10094455803",
    "10094455804",
    "10094455805",
    "10094455806",
    "10094455807",
    "10094455808",
    "10094455873",
    "10094455874",
    "10094455875",
    "10094455876",
    "10094455877",
    "10094455809",
    "10094455810",
    "10094455811",
    "10094455812",
    "10094455813",
    "10094455814",
    "10094455815",
    "10094455816",
    "10094455817",
    "10094455818",
    "10094455878",
    "10094455879",
    "10094455880",
    "10094455881",
    "10094455882",
    "10094455819",
    "10094455820",
    "10094455821",
    "10094455822",
    "10094455823",
    "10094455824",
    "10094455825",
    "10094455826",
    "10094455827",
    "10094455828",
    "10094455883",
    "10094455883",
    "10094455885",
    "10094455886",
    "10094455887",
    "10094455829",
    "10094455830",
    "10094455831",
    "10094455832",
    "10094455833",
    "10094455834",
    "10094455835",
    "10094455836",
    "10094455837",
    "10094455838",
    "10094455888",
    "10094455889",
    "10094455890",
    "10094455891",
    "10094455892",
    "10094455839",
    "10094455840",
    "10094455841",
    "10094455842",
    "10094455843",
    "10094455844",
    "10094455845",
    "10094455846",
    "10094455847",
    "10094455848",
    "10094455893",
    "10094455894",
    "10094455895",
    "10094455896",
    "10094455897",
    "10094455849",
    "10094455850",
    "10094455851",
    "10094455852",
    "10094455853",
    "10094455854",
    "10094455855",
    "10094455856",
    "10094455857",
    "10094455858",
    "10094455859",
    "10094455860",
    "10094455861",
    "10094455862",
    "10094455863",
    "10094455864",
    "10094455865",
    "10094455866",
    "10094455867",
    "10094455893",
    "10094455894",
    "10094455895",
    "10094455896",
    "10094455897",
    "10094455849",
    "10094455850",
    "10094455851",
    "10094455852",
    "10094455853",
    "10094455854",
    "10094455855",
    "10094455856",
    "10094455857",
    "10094455858",
    "10094455859",
    "10094455860",
    "10094455861",
    "10094455862",
    "10094455863",
    "10094455864",
    "10094455865",
    "10094455866",
    "10094455867",
    "10094455800",
    "10094455801",
    "10094455868",
    "10094455869",
    "10094455870",
    "10094455871",
    "10094455872",
    "10094455802",
    "10094455803",
    "10094455804",
    "10094455805",
    "10094455806",
    "10094455807",
    "10094455808",
    "10094455873",
    "10094455874",
    "10094455875",
    "10094455876",
    "10094455877",
    "10094455809",
    "10094455810",
    "10094455811",
    "10094455812",
    "10094455813",
    "10094455814",
    "10094455815",
    "10094455816",
    "10094455817",
    "10094455818",
    "10094455878",
    "10094455879",
    "10094455880",
    "10094455881",
    "10094455882",
    "10094455819",
    "10094455820",
    "10094455821",
    "10094455822",
    "10094455823",
    "10094455824",
    "10094455825",
    "10094455826",
    "10094455827",
    "10094455828",
    "10094455883",
    "10094455883",
    "10094455885",
    "10094455886",
    "10094455887",
    "10094455829",
    "10094455830",
    "10094455831",
    "10094455832",
    "10094455833",
    "10094455834",
    "10094455835",
    "10094455836",
    "10094455837",
    "10094455838",
    "10094455888",
    "10094455889",
    "10094455890",
    "10094455891",
    "10094455892",
    "10094455839",
    "10094455840",
    "10094455841",
    "10094455842",
    "10094455843",
    "10094455844",
    "10094455845",
    "10094455846",
    "10094455847",
    "10094455848",
]


class Command(BaseXpressDemocracyClubCsvImporter):
    council_id = "CRW"
    addresses_name = "2021-03-19T10:25:17.143451/Crawley Democracy_Club__06May2021.tsv"
    stations_name = "2021-03-19T10:25:17.143451/Crawley Democracy_Club__06May2021.tsv"
    elections = ["2021-05-06"]
    csv_delimiter = "\t"

    def station_record_to_dict(self, record):

        # Furnace Green Community Centre
        if record.polling_place_id == "968":
            record = record._replace(polling_place_easting="528414")
            record = record._replace(polling_place_northing="135782")

        # Wakehams Green Community Centre
        if record.polling_place_id == "983":
            record = record._replace(polling_place_easting="529968")
            record = record._replace(polling_place_northing="138172")

        # Southgate West Community Centre
        if record.polling_place_id == "989":
            record = record._replace(polling_place_easting="526307")
            record = record._replace(polling_place_northing="135610")

        return super().station_record_to_dict(record)

    def address_record_to_dict(self, record):
        uprn = record.property_urn.strip().lstrip("0")

        if uprn in [
            "200001224606",  # CARETAKER FLAT TA CENTRE 29 KILNMEAD, NORTHGATE, CRAWLEY
        ]:
            return None

        if record.addressline6 in ["RH10 7AU"]:
            return None

        # Council correction
        # Send these uprns to:
        # Three Bridges Community Centre Gales Place Three Bridges Crawley
        if uprn in BRIDGEFIELD_HOUSE_UPRNS:
            record = record._replace(polling_place_id="993")

        return super().address_record_to_dict(record)
