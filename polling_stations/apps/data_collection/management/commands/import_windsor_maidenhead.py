from data_collection.management.commands import BaseHalaroseCsvImporter


class Command(BaseHalaroseCsvImporter):
    council_id = "E06000040"
    addresses_name = "local.2019-05-02/Version 1/polling_station_export-2019-03-11.csv"
    stations_name = "local.2019-05-02/Version 1/polling_station_export-2019-03-11.csv"
    elections = ["local.2019-05-02", "europarl.2019-05-23"]
    csv_encoding = "windows-1252"

    def address_record_to_dict(self, record):
        rec = super().address_record_to_dict(record)
        uprn = record.uprn.strip().lstrip("0")

        if record.houseid.strip() == "68232":
            rec["postcode"] = "SL6 2DF"
            rec["accept_suggestion"] = False

        if record.houseid.strip() == "67980":
            rec["postcode"] = "SL4 6DP"
            rec["accept_suggestion"] = False

        if uprn in [
            "100081046115",  # SL63QU -> SL63QP : GORSELANDS HOUSE BURCHETTS GREEN LANE, BURCHETTS GREEN, MAIDENHEAD, WINDSOR AND MAIDENHEAD
            "100081047679",  # SL66QP -> SL66QR : NORTH WING FLAT BURCHETTS GREEN ROAD, BURCHETTS GREEN, MAIDENHEAD, WINDSOR AND MAIDENHEAD
            "100081341284",  # SL66QP -> SL66QR : NORTH WING 1-8 BURCHETTS GREEN ROAD, BURCHETTS GREEN, MAIDENHEAD, WINDSOR AND MAIDENHEAD
            "10012326294",  # SL61BN -> SL61NB : 15 QUEEN STREET, MAIDENHEAD, WINDSOR AND MAIDENHEAD
            "100081051915",  # TW195JB -> TW195DH : CHURCH MEADOWS WINDSOR ROAD, WRAYSBURY, STAINES UPON THAMES, WINDSOR AND MAIDENHEAD
            "10012320459",  # SL43FG -> SL44AE : 16A SHERBOURNE DRIVE, WINDSOR, WINDSOR AND MAIDENHEAD
        ]:
            rec["accept_suggestion"] = True

        if uprn in [
            "100081047350",  # SL62NN -> SL63SX : ANNEXE SCIPETTS LODGE BLACKBIRD LANE, MAIDENHEAD, WINDSOR AND MAIDENHEAD
            "10012327280",  # SL66PD -> SL66PB : RASHLEIGHS DARLINGS LANE, MAIDENHEAD, WINDSOR AND MAIDENHEAD
            "100081043052",  # SL59JP -> SL59JU : HURST LODGE SCHOOL (DORMITORIES) BAGSHOT ROAD, ASCOT, WINDSOR AND MAIDENHEAD
            "10012308726",  # SL59JL -> SL59JP : THE COACH HOUSE FOREST RIDGE BAGSHOT ROAD, ASCOT, WINDSOR AND MAIDENHEAD
            "100081044332",  # SL50AU -> SL50AT : SHERBOURNE HOUSE RISE ROAD, SUNNINGDALE, ASCOT, WINDSOR AND MAIDENHEAD
            "100081044396",  # SL50QD -> SL50QB : NORTH LODGE SILWOOD ROAD, ASCOT, WINDSOR AND MAIDENHEAD
            "100081044420",  # SL59AP -> SL59AS : CLYNE LODGE ST MARYS HILL, ASCOT, WINDSOR AND MAIDENHEAD
            "100081043150",  # SL57DQ -> SL57DH : FENSACRE HOUSE COOMBE LANE, ASCOT, WINDSOR AND MAIDENHEAD
            "100081043931",  # SL57DH -> SL57DL : WELLSBRIDGE HOUSE COOMBE LANE, ASCOT, WINDSOR AND MAIDENHEAD
            "100081047819",  # SL65LH -> SL66QW : LITTLE TEMPLE TEMPLE GOLF CLUB HENLEY ROAD, HURLEY, MAIDENHEAD, WINDSOR AND MAIDENHEAD
            "100081044744",  # SL57QP -> SL57RG : KEEPERS COTTAGE WATERSPLASH LANE, ASCOT, WINDSOR AND MAIDENHEAD
            "100081047188",  # SL62DX -> SL62DT : 3 FIFIELD ROAD, BRAY, MAIDENHEAD, WINDSOR AND MAIDENHEAD
            "100081044325",  # SL50BP -> SL50BH : FLAT 4 GALTON ROAD, ASCOT, WINDSOR AND MAIDENHEAD
            "10012331225",  # SL46FB -> SL41QN : 1 15 BROCAS STREET, ETON, WINDSOR, WINDSOR AND MAIDENHEAD
        ]:
            rec["accept_suggestion"] = False

        return rec
